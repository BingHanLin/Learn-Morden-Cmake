1. create and link a static library.
2. using out of source build.

https://stackoverflow.com/questions/31661264/cmake-generators-for-visual-studio-do-not-set-cmake-configuration-types

Multi-configuration generator
Single-configuration generator